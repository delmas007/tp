<div class="card">
  <p-toast position="top-right"></p-toast>

  <p-confirmDialog
    [style]="{ width: '450px' }"
    header="Confirmation de suppression"
    icon="pi pi-exclamation-triangle"
    acceptLabel="Oui, supprimer"
    rejectLabel="Annuler"
    acceptButtonStyleClass="p-button-danger"
    rejectButtonStyleClass="p-button-secondary">
  </p-confirmDialog>

  <p-table
    [value]="personnesFiltrees"
    [tableStyle]="{ 'min-width': '50rem' }"
    sortField="nom"
    [sortOrder]="1">
    <ng-template #header>
      <tr>
        <th pSortableColumn="nom">
          Nom
          <p-sortIcon field="nom"></p-sortIcon>
        </th>
        <th>Prénom</th>
        <th>
          <div class="age-header">
            Âge
            <button
              pButton
              type="button"
              icon="pi pi-filter"
              class="p-button-text p-button-sm filter-button"
              [pTooltip]="getFilterTooltip()"
              tooltipPosition="top"
              (click)="menu.toggle($event)"
              [class.active-filter]="filtreAge !== 'tous'"
              [attr.aria-label]="getFilterTooltip()">
            </button>
            <p-menu #menu [popup]="true" [model]="menuItems" [appendTo]="'body'"></p-menu>
          </div>
        </th>
        <th>Statut</th>
        <th>Département</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template #body let-personne>
      <tr>
        <td>{{ personne.nom }}</td>
        <td>{{ personne.prenom }}</td>
        <td>{{ personne.age }}</td>
        <td>
          <span
            class="status-badge"
            [class.mineur]="personne.age < 18"
            [class.majeur]="personne.age >= 18">
            {{ personne.age < 18 ? 'Mineur' : 'Majeur' }}
          </span>
        </td>
        <td>{{ personne.departement.designation }}</td>
        <td class="action-buttons">
          <button
            pButton
            pRipple
            type="button"
            icon="pi pi-plus"
            class="p-button-rounded p-button-success p-button-sm"
            pTooltip="Ajouter"
            tooltipPosition="top"
            (click)="ajouter(personne)">
          </button>

          <button
            pButton
            pRipple
            type="button"
            icon="pi pi-pencil"
            class="p-button-rounded p-button-info p-button-sm"
            pTooltip="Modifier"
            tooltipPosition="top"
            (click)="modifier(personne.id)">
          </button>

          <button
            pButton
            pRipple
            type="button"
            icon="pi pi-trash"
            class="p-button-rounded p-button-danger p-button-sm"
            pTooltip="Supprimer"
            tooltipPosition="top"
            (click)="confirmerSuppression(personne)">
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

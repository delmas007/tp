<div class="card">
  <p-toast position="top-right"></p-toast>

  <p-confirmDialog
    [style]="{ width: '450px' }"
    header="Confirmation de suppression"
    icon="pi pi-exclamation-triangle"
    acceptLabel="Oui, supprimer"
    rejectLabel="Annuler"
    acceptButtonStyleClass="p-button-danger"
    rejectButtonStyleClass="p-button-secondary">
  </p-confirmDialog>

  <!-- Filtre par âge -->
  <div class="filter-section mb-4">
    <h4>Filtre par catégorie d'âge</h4>
    <div class="p-field-radiobutton">
      <p-radioButton
        inputId="tous"
        name="filtreAge"
        value="tous"
        [(ngModel)]="filtreAge"
        (onClick)="appliquerFiltre()">
      </p-radioButton>
      <label for="tous" class="ml-2">Tous</label>
    </div>
    <div class="p-field-radiobutton">
      <p-radioButton
        inputId="mineurs"
        name="filtreAge"
        value="mineurs"
        [(ngModel)]="filtreAge"
        (onClick)="appliquerFiltre()">
      </p-radioButton>
      <label for="mineurs" class="ml-2">Mineurs (moins de 18 ans)</label>
    </div>
    <div class="p-field-radiobutton">
      <p-radioButton
        inputId="majeurs"
        name="filtreAge"
        value="majeurs"
        [(ngModel)]="filtreAge"
        (onClick)="appliquerFiltre()">
      </p-radioButton>
      <label for="majeurs" class="ml-2">Majeurs (18 ans et plus)</label>
    </div>
  </div>

  <p-table
    [value]="personnesFiltrees"
    [tableStyle]="{ 'min-width': '50rem' }"
    sortField="nom"
    [sortOrder]="1">
    <ng-template #header>
      <tr>
        <th pSortableColumn="nom">
          Nom
          <p-sortIcon field="nom"></p-sortIcon>
        </th>
        <th>Prénom</th>
        <th>Âge</th>
        <th>Statut</th>
        <th>Département</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template #body let-personne>
      <tr>
        <td>{{ personne.nom }}</td>
        <td>{{ personne.prenom }}</td>
        <td>{{ personne.age }}</td>
        <td>
          <span
            class="status-badge"
            [class.mineur]="personne.age < 18"
            [class.majeur]="personne.age >= 18">
            {{ personne.age < 18 ? 'Mineur' : 'Majeur' }}
          </span>
        </td>
        <td>{{ personne.departement.designation }}</td>
        <td class="action-buttons">
          <button
            pButton
            pRipple
            type="button"
            icon="pi pi-plus"
            class="p-button-rounded p-button-success p-button-sm"
            pTooltip="Ajouter"
            tooltipPosition="top"
            (click)="ajouter(personne)">
          </button>

          <button
            pButton
            pRipple
            type="button"
            icon="pi pi-pencil"
            class="p-button-rounded p-button-info p-button-sm"
            pTooltip="Modifier"
            tooltipPosition="top"
            (click)="modifier(personne.id)">
          </button>

          <button
            pButton
            pRipple
            type="button"
            icon="pi pi-trash"
            class="p-button-rounded p-button-danger p-button-sm"
            pTooltip="Supprimer"
            tooltipPosition="top"
            (click)="confirmerSuppression(personne)">
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
